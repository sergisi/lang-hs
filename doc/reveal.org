#+TITLE: Llenguatges funcionals

* Introducció
** Cas d'estudi Haskell
** Cas d'estudi Idris

* Haskell
** Problemàtica
Visions diferents sobre l'objectiu de la compilació:
- C
- LLVM
- Codi natiu
** Solució: Llenguatge intermedi
#+begin_src dot :file img/lleng-inter.png :cmdline -Tpng :exports none :results silent
digraph G {

    Haskell -> "Llenguatge Intermedi" -> C;
    "Llenguatge Intermedi" -> LLVM
    "Llenguatge Intermedi" -> "Codi natiu"
}
#+end_src

[[file:img/lleng-inter.png]]
** Cmm
Neix de C--
#+begin_comment
- Neix de C--
- No te res d'alt nivell
  + Tipus
- Les especificacions estan fetes per assemblar-se encara més a codi màquina
- A nivell de haskell, ens permet transformar funcions recursives a iteratives.
- Eliminar els tipus.
- Eliminar les generalitzacions.
#+end_comment

** Diferencies entre ells
#+begin_comment
https://downloads.haskell.org/ghc/latest/docs/html/users_guide/codegens.html
#+end_comment
*** Codi natiu
#+begin_comment
- Optimitzacions
  + Eliminar registres per graph coloring
- Diferents arquitectures
  + Com x86 o Darwin
- L'objectiu és compilar el codi relativament ràpid i que el codi sigui relativament ràpid
#+end_comment
*** C
#+begin_comment
- Primer backend que es va realitzar
- Es desencoratge al seu ús, més enllà de curiositat.
- Està deprecated desde fa anys.
#+end_comment
*** LLVM
#+begin_comment
Que és LLVM?
- No es un acronim.
- Es un compilador obert a extensions.
- Es obert a nous llenguatges de programació.
- Llicència Apache: Restriccions menys dures que gcc (GPL vs Apache)
Compiladors de llengues conegudes:
- Rust
- Java
- Clang

En ghc:
- El compilat pot ser més ràpid, sobretot si s'utilitza moltes arrays i nombres (estrany en haskell).
- Compila molt més lent.
#+end_comment

* Idris
** Que és Idris
#+begin_comment
Que és Idris?
- Idris és un llenguatge funcional
- Dependent types
  - No hi ha tanta distinció entre tipus i valors
  - Tipus depenen de valors
- Llenguatge per a encoratjar el Type Driven Development
  - Els tipus són eines per a crear els programes. Es defineixen els tipus 
    del nostre programa i s'utilitza el compilador i el type checker per A
    cosntruir un programa complet que satisfagi el tipus. 
    Com més informació tinguem sobreels tipus, mes seguretat tindrem
    de que el nostre programa serà correcte.
#+end_comment

** Problemàtica
De mateixa manera que haskell, idirs te visions diferents sobre l'objectiu de la compilació.
Idirs ha estat disenyat per a poguer generar codi per diferents backends.

** Backends Oficials:
- Per Defecte: C
- Per Web: Javascript, Node.js

** Third Party:
No son mantinguts per els desenvolupadors d'idris
- .NET, Mono, Unity
- Erlang
- Java
- JVM
- LLVM
- Malfunction
- Ocaml
- Python
- PHP
- Ruby

** Llenguatge Intermedi
Per això, idirs abans de traduir a un dels backends disponibles, 
tradueix a un llenguatge intermedi anomenat: TT (perque s'asembla a 
la lletra grega pi majuscula).

** Llenguatge Intermedi
#+begin_src dot :file img/lleng-inter2.png :cmdline -Tpng :exports none :results silent
digraph G {

    Idris -> "Llenguatge Intermedi" -> C;
    "Llenguatge Intermedi" -> Javascript
    "Llenguatge Intermedi" -> "Node.js"
    "Llenguatge Intermedi" -> "Python"
    "Llenguatge Intermedi" -> "LLVM"
    "Llenguatge Intermedi" -> "..."
}
#+end_src